---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

const modules = await getCollection('modules');
const sortedModules = modules.sort((a, b) => a.data.moduleNumber - b.data.moduleNumber);
---

<BaseLayout title="Modules Â· Astro Learning Blog" headerTitle="Modules">
	<div slot="hero" class="space-y-2 rounded-xl bg-white/80 p-8 shadow ring-1 ring-slate-200">
		<p class="text-sm font-semibold uppercase tracking-wide text-indigo-500">Learning Log</p>
		<h1 class="text-3xl font-bold text-slate-900">Astro Modules</h1>
		<p class="text-slate-600">A timeline of the deliberate practice modules, updated as they progress.</p>
	</div>

	<section class="space-y-8">
		{sortedModules.map(({ id, data, slug }) => (
			<article id={slug} class="rounded-2xl border border-slate-200 bg-white/80 p-8 shadow-sm ring-1 ring-slate-200">
				<header class="mb-4 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
					<div>
						<p class="text-xs font-semibold uppercase tracking-wide text-indigo-500">Module {data.moduleNumber}</p>
						<h2 class="text-2xl font-bold text-slate-900">
							<a class="transition hover:text-indigo-600" href={`/modules/${slug}/`}>
								{data.title}
							</a>
						</h2>
					</div>
					<span class="rounded-full bg-slate-100 px-3 py-1 text-sm font-medium text-slate-600">
						{data.status === 'complete' ? 'Complete' : data.status === 'in-progress' ? 'In progress' : 'Planned'}
					</span>
				</header>
				<p class="text-slate-600">{data.summary}</p>
				<small class="text-xs text-slate-500">
					Published {data.publishedAt.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
				</small>
			</article>
		))}
	</section>
</BaseLayout>
